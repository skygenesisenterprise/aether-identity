# Dockerfile.dev pour Aether Identity Server
# Utilisé pour le développement avec hot-reload

# Utiliser l'image officielle Go
FROM golang:1.25.5-alpine AS builder

# Définir le répertoire de travail
WORKDIR /app

# Copier le fichier go.mod et go.sum
COPY server/go.mod server/go.sum ./

# Télécharger les dépendances
RUN go mod download

# Copier le code source
COPY server/ .

# Construire l'application
RUN go build -o aether-server main.go

# Image finale légère
FROM alpine:latest

# Installer les dépendances nécessaires
RUN apk add --no-cache ca-certificates

# Copier l'application construite
COPY --from=builder /app/aether-server /aether-server

# Exposer le port
EXPOSE 8080

# Commande par défaut
CMD ["/aether-server"]
